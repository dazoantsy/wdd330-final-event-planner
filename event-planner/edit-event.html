<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Edit event â€” Event Planner</title>
    <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
    <link rel="stylesheet" href="../css/style.css" />
</head>

<body>
    <a href="#main" class="sr-only">Skip to main content</a>

    <script>
        (function () {
            try {
                var now = Math.floor(Date.now() / 1000);
                for (var i = 0; i < localStorage.length; i++) {
                    var k = localStorage.key(i);
                    if (!/^sb-.*-auth-token$/.test(k)) continue;
                    var raw = localStorage.getItem(k); if (!raw) continue;
                    var s = JSON.parse(raw); var ss = s.currentSession || s.session || s;
                    var exp = typeof ss?.expires_at === "number" ? ss.expires_at : 0;
                    if (exp > now) return;
                }
            } catch { }
            location.replace("../index.html");
        }());
    </script>

    <div id="__header"></div>

    <main id="main" class="container" role="main" aria-labelledby="page-title">

        <h1 id="page-title">Edit event</h1>

        <form id="form" class="form" autocomplete="off">
            <label>Title
                <input id="title" type="text" required />
            </label>

            <div class="row" style="display:flex; gap:8px; align-items:end">
                <label style="flex:1">Start
                    <input id="start" type="datetime-local" required />
                </label>
                <label style="flex:1">End
                    <input id="end" type="datetime-local" />
                </label>
            </div>

            <label>Location
                <input id="location" type="text" list="loc-suggestions" placeholder="City, place..." required />
                <datalist id="loc-suggestions"></datalist>
            </label>

            <label>Description
                <textarea id="description" rows="4"></textarea>
            </label>

            <div class="row">
                <button id="submit" type="submit" class="btn">Save changes</button>
                <a id="back" href="./index.html" class="btn ghost">Back</a>
            </div>

            <p id="status" class="status" role="status" aria-live="polite"></p>


            <div class="muted" id="weather-box"></div>
            <button id="weather-btn" type="button" class="btn ghost">Check weather</button>
        </form>
    </main>

    <div id="__footer"></div>

    <script type="module">
        import { loadPartials } from "../js/load-partials.js";
        await loadPartials();
        await import("../js/auth.js");
        await import("../js/header-logo.js");
        await import("../js/event-edit.js");
    </script>

</body>

</html>
